<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zed.City API Explorer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1e1e2f;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      background: #292940;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
    }
    .container {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 1rem;
    }
    .search-bar {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 1rem;
      font-size: 1rem;
      border-radius: 8px;
      border: none;
    }
    .endpoint {
      background: #2d2d44;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
    }
    .endpoint h3 {
      margin: 0 0 0.5rem 0;
      font-size: 1.2rem;
      color: #4fd1c5;
    }
    .endpoint input {
      width: 70%;
      padding: 0.3rem;
      border-radius: 6px;
      border: none;
      margin-right: 0.5rem;
    }
    button {
      padding: 0.4rem 0.7rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background: #4fd1c5;
      color: #000;
      font-weight: bold;
      margin-right: 0.3rem;
    }
    button:hover {
      background: #38b2ac;
    }
    .result-container {
      margin-top: 0.5rem;
    }
    pre {
      background: #111;
      padding: 0.5rem;
      border-radius: 8px;
      max-height: 300px;
      overflow: auto;
      margin-top: 0.5rem;
      display: none; /* Hidden until toggled */
    }
  </style>
</head>
<body>
  <header>Zed.City API Explorer</header>
  <div class="container">
    <input type="text" class="search-bar" placeholder="Search endpoints..." oninput="filterEndpoints(event)" />

    <div id="endpoints"></div>
  </div>

  <script>
    const proxy = "https://corsproxy.io/?";

    const endpoints = [
      { name: "Get Quests", url: "https://api.zed.city/getQuests" },
      { name: "Get Hunting", url: "https://api.zed.city/getHunting" },
      { name: "Get Scavenge", url: "https://api.zed.city/getScavenge" },
      { name: "Get Skills", url: "https://api.zed.city/getSkills" },
      { name: "Get Perks", url: "https://api.zed.city/getPerks" },
      { name: "Get Trades", url: "https://api.zed.city/getTrades" },
      { name: "Get Settings", url: "https://api.zed.city/getSettings" },
      { name: "Get Explore", url: "https://api.zed.city/getExplore" },
      { name: "Get Location", url: "https://api.zed.city/getLocation" },
      { name: "Get Market", url: "https://api.zed.city/getMarket" },
      { name: "Get Recipes", url: "https://api.zed.city/getRecipes?type=${type}" },
      { name: "Get Stronghold", url: "https://api.zed.city/getStronghold" },
      { name: "Get Stats", url: "https://api.zed.city/getStats" },
      { name: "Get RadioTower by ID", url: "https://api.zed.city/getRadioTower?id=${radioId}" },
      { name: "Get RadioTower", url: "https://api.zed.city/getRadioTower" },
      { name: "Load Items", url: "https://api.zed.city/loadItems" },
      { name: "Get Faction", url: "https://api.zed.city/getFaction" },
      { name: "Get Users", url: "https://api.zed.city/getUsers" },
      { name: "Get Faction Members", url: "https://api.zed.city/getFactionMembers" },
      { name: "Get Store", url: "https://api.zed.city/getStore?store_id=junk" },
      { name: "Get Fight", url: "https://api.zed.city/getFight" },
      { name: "Get Fight Log", url: "https://api.zed.city/getFightLog" }
    ];

    function renderEndpoints(list) {
      const container = document.getElementById("endpoints");
      container.innerHTML = "";
      list.forEach(ep => {
        const div = document.createElement("div");
        div.className = "endpoint";
        div.innerHTML = `
          <h3>${ep.name}</h3>
          <input type="text" value="${ep.url}" id="url-${ep.name}" />
          <button onclick="testAPI('${ep.name}')">Test API</button>
          <button onclick="toggleResult('${ep.name}')">Show Result</button>
          <div class="result-container">
            <pre id="result-${ep.name}"></pre>
          </div>
        `;
        container.appendChild(div);
      });
    }

    async function testAPI(name) {
      const url = document.getElementById(`url-${name}`).value;
      const resultBox = document.getElementById(`result-${name}`);
      resultBox.style.display = "block"; // ensure visible when testing
      resultBox.textContent = "Loading...";
      try {
        const res = await fetch(proxy + url);
        const data = await res.json();
        resultBox.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        resultBox.textContent = "Error: " + err;
      }
    }

    function toggleResult(name) {
      const resultBox = document.getElementById(`result-${name}`);
      if (resultBox.style.display === "none" || resultBox.style.display === "") {
        resultBox.style.display = "block";
      } else {
        resultBox.style.display = "none";
      }
    }

    function filterEndpoints(e) {
      const term = e.target.value.toLowerCase();
      const filtered = endpoints.filter(ep =>
        ep.name.toLowerCase().includes(term) || ep.url.toLowerCase().includes(term)
      );
      renderEndpoints(filtered);
    }

    renderEndpoints(endpoints);
  </script>
</body>
</html>

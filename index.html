<!DOCTYPE html>
<html lang="en" class="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zed.City API Explorer</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    pre { white-space: pre-wrap; word-wrap: break-word; }
  </style>
</head>
<body class="bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100 min-h-screen">
  <div class="max-w-6xl mx-auto p-6">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-extrabold text-indigo-700 dark:text-indigo-400">
        Zed.City API Explorer
      </h1>
      <button id="themeToggle" class="p-2 border rounded-lg">
        🌙
      </button>
    </div>

    <!-- Search -->
    <input id="searchInput" type="text" placeholder="🔍 Search endpoints..."
      class="w-full mb-6 p-2 border-2 border-indigo-300 rounded-lg focus:border-indigo-500 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100" />

    <!-- Sidebar + Content -->
    <div class="grid grid-cols-12 gap-6">
      <!-- Sidebar -->
      <aside class="col-span-3">
        <ul id="sidebar" class="space-y-2"></ul>
      </aside>

      <!-- Main -->
      <main id="content" class="col-span-9 space-y-6"></main>
    </div>
  </div>

  <script>
    const endpoints = [
      {
        category: "Quests & Exploration",
        items: [
          { name: "Get Quests", url: "https://api.zed.city/getQuests", method: "GET", description: "Fetch available quests.", params: [] },
          { name: "Get Explore", url: "https://api.zed.city/getExplore", method: "GET", description: "Explore locations.", params: [] },
          { name: "Get Location", url: "https://api.zed.city/getLocation", method: "GET", description: "Get current location info.", params: [] },
        ],
      },
      {
        category: "Combat",
        items: [
          { name: "Get Fight", url: "https://api.zed.city/getFight", method: "GET", description: "Start a fight.", params: [] },
          { name: "Get Fight Log", url: "https://api.zed.city/getFightLog", method: "GET", description: "Retrieve fight history.", params: [] },
        ],
      },
      {
        category: "World",
        items: [
          { name: "Get Hunting", url: "https://api.zed.city/getHunting", method: "GET", description: "Hunting-related data.", params: [] },
          { name: "Get Scavenge", url: "https://api.zed.city/getScavenge", method: "GET", description: "Scavenging resources.", params: [] },
          { name: "Get Radio Tower", url: "https://api.zed.city/getRadioTower", method: "GET", description: "Fetch radio towers.", params: [{ name: "id", placeholder: "Enter radioId" }] },
        ],
      },
      {
        category: "Player Data",
        items: [
          { name: "Get Stats", url: "https://api.zed.city/getStats", method: "GET", description: "Character stats.", params: [] },
          { name: "Get Skills", url: "https://api.zed.city/getSkills", method: "GET", description: "List skills.", params: [] },
          { name: "Get Perks", url: "https://api.zed.city/getPerks", method: "GET", description: "Fetch perks.", params: [] },
        ],
      },
      {
        category: "Economy",
        items: [
          { name: "Get Trades", url: "https://api.zed.city/getTrades", method: "GET", description: "Trade information.", params: [] },
          { name: "Get Market", url: "https://api.zed.city/getMarket", method: "GET", description: "Market listings.", params: [] },
          { name: "Get Recipes", url: "https://api.zed.city/getRecipes", method: "GET", description: "Fetch recipes by type.", params: [{ name: "type", placeholder: "Enter recipe type" }] },
          { name: "Get Store", url: "https://api.zed.city/getStore", method: "GET", description: "Store data.", params: [{ name: "store_id", placeholder: "Enter store ID (e.g. junk)" }] },
        ],
      },
      {
        category: "Factions",
        items: [
          { name: "Get Faction", url: "https://api.zed.city/getFaction", method: "GET", description: "Faction details.", params: [] },
          { name: "Get Faction Members", url: "https://api.zed.city/getFactionMembers", method: "GET", description: "List faction members.", params: [] },
        ],
      },
      {
        category: "Other",
        items: [
          { name: "Get Settings", url: "https://api.zed.city/getSettings", method: "GET", description: "Game settings.", params: [] },
          { name: "Get Stronghold", url: "https://api.zed.city/getStronghold", method: "GET", description: "Stronghold info.", params: [] },
          { name: "Load Items", url: "https://api.zed.city/loadItems", method: "GET", description: "Load items data.", params: [] },
          { name: "Get Users", url: "https://api.zed.city/getUsers", method: "GET", description: "All users list.", params: [] },
        ],
      },
    ];

    const sidebar = document.getElementById("sidebar");
    const content = document.getElementById("content");
    const searchInput = document.getElementById("searchInput");

    // Render sidebar
    endpoints.forEach((group, i) => {
      const li = document.createElement("li");
      li.innerHTML = `<button class="w-full text-left p-2 rounded hover:bg-indigo-100 dark:hover:bg-indigo-800" data-index="${i}">${group.category}</button>`;
      sidebar.appendChild(li);
    });

    // Render endpoint cards
    function renderContent(filter = "") {
      content.innerHTML = "";
      endpoints.forEach((group, gi) => {
        const section = document.createElement("div");
        section.innerHTML = `<h2 class="text-2xl font-bold mb-2 text-indigo-600 dark:text-indigo-400">${group.category}</h2>`;
        group.items
          .filter((ep) =>
            ep.name.toLowerCase().includes(filter.toLowerCase()) ||
            ep.description.toLowerCase().includes(filter.toLowerCase())
          )
          .forEach((ep) => {
            const card = document.createElement("div");
            card.className = "p-4 mb-4 border rounded-lg shadow dark:bg-gray-800";
            card.innerHTML = `
              <div class="flex justify-between items-center">
                <h3 class="text-lg font-semibold">${ep.name}</h3>
                <button class="copyUrl p-1 border rounded text-sm">Copy URL</button>
              </div>
              <p class="text-sm mb-2">${ep.description}</p>
              <code class="text-xs block mb-2">${ep.url}</code>
              ${ep.params.map(p => `<input data-param="${p.name}" placeholder="${p.placeholder}" class="paramInput w-full p-2 mb-2 border rounded dark:bg-gray-700">`).join("")}
              <button class="testApi bg-indigo-600 text-white px-3 py-1 rounded">Test API</button>
              <pre class="response mt-2 p-2 bg-gray-100 dark:bg-gray-900 rounded max-h-60 overflow-auto"></pre>
            `;
            section.appendChild(card);

            // Copy
            card.querySelector(".copyUrl").addEventListener("click", () => {
              navigator.clipboard.writeText(ep.url);
            });

            // Test API
            card.querySelector(".testApi").addEventListener("click", async () => {
              const params = {};
              card.querySelectorAll(".paramInput").forEach(input => {
                if (input.value) params[input.dataset.param] = input.value;
              });
              let url = ep.url;
              if (Object.keys(params).length) {
                url += "?" + new URLSearchParams(params).toString();
              }
              const resEl = card.querySelector(".response");
              resEl.textContent = "Loading...";
              try {
                const res = await fetch(url);
                const data = await res.json();
                resEl.textContent = JSON.stringify(data, null, 2);
              } catch (err) {
                resEl.textContent = "Error: " + err.message;
              }
            });
          });
        if (section.children.length > 1) content.appendChild(section);
      });
    }

    renderContent();

    // Sidebar filter
    sidebar.querySelectorAll("button").forEach((btn, i) => {
      btn.addEventListener("click", () => {
        content.innerHTML = "";
        renderContent();
        document.querySelectorAll("h2")[i].scrollIntoView({ behavior: "smooth" });
      });
    });

    // Search filter
    searchInput.addEventListener("input", (e) => {
      renderContent(e.target.value);
    });

    // Dark mode toggle
    const themeToggle = document.getElementById("themeToggle");
    function setTheme(theme) {
      if (theme === "dark") {
        document.documentElement.classList.add("dark");
        localStorage.setItem("theme", "dark");
        themeToggle.textContent = "☀️";
      } else {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("theme", "light");
        themeToggle.textContent = "🌙";
      }
    }
    setTheme(localStorage.getItem("theme") || "light");
    themeToggle.addEventListener("click", () => {
      setTheme(document.documentElement.classList.contains("dark") ? "light" : "dark");
    });
  </script>
</body>
</html>
